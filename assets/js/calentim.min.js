!function(b,o,c,a){function e(t,e){this.elem=t,this.$elem=b(t),this.options=e,this.metadata=this.$elem.data("plugin-options")}e.defaults=(e.prototype={public:function(){return{startDate:moment(),endDate:moment(),format:"L LT",dateSeparator:" - ",calendarCount:2,mobileBreakpoint:760,isHotelBooking:!1,inline:!1,minDate:null,maxDate:null,showHeader:!0,showFooter:!0,rangeOrientation:"horizontal",verticalRangeWidth:180,showTimePickers:!0,showCalendars:!0,showButtons:!1,hourFormat:12,dontPrefixHours:!1,minuteSteps:1,startOnMonday:!1,container:"body",oneCalendarWidth:230,enableKeyboard:!0,showOn:"bottom",arrowOn:"left",autoAlign:!0,locale:moment.locale("en"),singleDate:!1,target:null,autoCloseOnSelect:!1,startEmpty:!1,ranges:[{title:"Today",startDate:moment().startOf("day"),endDate:moment().endOf("day")},{title:"3 Days",startDate:moment().startOf("day"),endDate:moment().add(2,"days").endOf("day")},{title:"5 Days",startDate:moment().startOf("day"),endDate:moment().add(4,"days").endOf("day")},{title:"1 Week",startDate:moment().startOf("day"),endDate:moment().add(6,"days").endOf("day")},{title:"Till Next Week",startDate:moment().startOf("day"),endDate:moment().endOf("week").endOf("day")},{title:"Till Next Month",startDate:moment().startOf("day"),endDate:moment().endOf("month").endOf("day")}],rangeLabel:"Ranges: ",cancelLabel:"Cancel",applyLabel:"Apply",nextMonthIcon:"<i class='fa fa-arrow-right'></i>",prevMonthIcon:"<i class='fa fa-arrow-left'></i>",rangeIcon:"<i class='fa fa-retweet'></i>",headerSeparator:"<i class='fa fa-chevron-right'></i>",onbeforeselect:function(){return!0},onCancel:function(){return!0},onafterselect:function(){},onbeforeshow:function(){},onbeforehide:function(){},onaftershow:function(){},onafterhide:function(){},onfirstselect:function(){},onrangeselect:function(){},onbeforemonthchange:function(){return!0},onaftermonthchange:function(){},onafteryearchange:function(){},ondraw:function(){},onBeforeInit:function(){},onBeforeDestroy:function(){return!0},ondestroy:function(){},validateClick:function(){return!0},oninit:function(){},ontimechange:function(){},disableDays:function(){return!1},limitTimeForDay:function(){return{start:{hour:0,minute:0,ampm:null},end:{hour:23,minute:59,ampm:null}}},disabledRanges:[],continuous:!1,disableOnlyStart:!1,disableOnlyEnd:!1,minSelectedDays:0,enableMonthSwitcher:!0,monthSwitcherFormat:"MMMM",enableYearSwitcher:!0,enableSwipe:!0,numericMonthSelector:!1,reverseTimepickerArrows:!1,showWeekNumbers:!1,hideOutOfRange:!1,DOBCalendar:!1,isRTL:!1}},private:function(){return{startSelected:!1,currentDate:moment(),endSelected:!0,hoverDate:null,keyboardHoverDate:null,headerStartDay:null,headerStartDate:null,headerStartWeekday:null,headerEndDay:null,headerEndDate:null,headerEndWeekday:null,swipeTimeout:null,isMobile:!1,valElements:["BUTTON","OPTION","INPUT","LI","METER","PROGRESS","PARAM"],dontHideOnce:!1,initiator:null,initComplete:!1,startDateBackup:null,firstValueSelected:!1,startDateInitial:null,endDateInitial:null,startScrolling:!1,lastScrollDirection:"bottom",throttleTimeout:null,documentEvent:null,delayInputUpdate:!1,startTimeBackup:null,endTimeBackup:null,mouseTimer:!1,preventMouseClick:!1,lastScrollX:0,lastScrollY:0,isTicking:!1,parentScrollEventsAttached:!1,rafID:0,disabledDays:{},skipTabKeyOnInput:!1}},init:function(){return this.config=b.extend({},this.public(),this.options,this.metadata),this.globals=b.extend({},this.private()),this.globals.isMobile=this.checkMobile(),b("body").addClass(this.checkTouch()?"calentim-touch":"calentim-notouch"),this.config.onBeforeInit(this),this.applyConfig(),this.fetchInputs(),!1!==this.config.startEmpty&&!this.globals.firstValueSelected||(this.globals.currentDate=moment(this.config.startDate)),this.drawUserInterface(),this.addInitialEvents(),this.$elem.data("calentim",this),this.config.oninit(this),this.globals.initComplete=!0,this.globals.lastScrollX=o.scrollX||o.pageXOffset||c.documentElement.scrollLeft,this.globals.lastScrollY=o.scrollY||o.pageYOffset||c.documentElement.scrollTop,b(o).trigger("resize.calentim"),this},validateDates:function(){var t,e,i,n;null!==this.config.startDate&&null!==this.config.endDate&&(t=moment(this.config.startDate,this.config.format).locale(this.config.locale),e=moment(this.config.endDate,this.config.format).locale(this.config.locale),i=moment().locale(this.config.locale),!1===this.config.singleDate?(t.isValid()&&e.isValid()?t.isBefore(e)?(this.config.startDate=t.clone(),this.config.endDate=e.clone()):(this.config.startDate=e.clone(),this.config.endDate=t.clone()):(this.config.startDate=i.clone(),this.config.endDate=i.clone()),this.config.startDate=this.TimeInsideLimits(this.config.startDate,"start"),this.config.endDate=this.TimeInsideLimits(this.config.endDate,"end")):(!1===t.isValid()?this.config.startDate=i.clone():this.config.startDate=t.clone(),this.config.startDate=this.TimeInsideLimits(this.config.startDate,"start")),(n=i=null)!==this.config.minDate&&((i=moment(this.config.minDate,this.config.format).locale(this.config.locale)).isValid()?this.config.minDate=i.clone():i=this.config.minDate=null),null!==this.config.maxDate&&((n=moment(this.config.maxDate,this.config.format).locale(this.config.locale)).isValid()?!i||i.isBefore(n)?this.config.maxDate=n.clone():(this.config.minDate=n.clone(),this.config.maxDate=i.clone()):n=this.config.maxDate=null),i&&t&&i.isAfter(t,"day")&&(this.config.startDate=i.clone()),i&&e&&i.isAfter(e,"day")&&(this.config.endDate=i.clone()),n&&t&&n.isBefore(t,"day")&&(this.config.startDate=n.clone()),null!==n&&null!==e&&n.isBefore(e,"day")&&(this.config.endDate=n.clone()),(!1===this.checkRangeContinuity()||1==this.config.disableOnlyStart&&this.isDisabled(this.config.startDate,this.config.isHotelBooking)||!1===this.config.singleDate&&this.config.disableOnlyEnd&&this.isDisabled(this.config.endDate,this.config.isHotelBooking)||this.config.startEmpty&&0==this.globals.firstValueSelected)&&this.clearInput())},applyConfig:function(){null===this.config.target&&(this.config.target=this.$elem),!0===this.config.inline&&(this.config.DOBCalendar=!1),1==this.config.DOBCalendar&&(this.config.singleDate=!0),["startDate","endDate","minDate","maxDate"].forEach(function(t){this.config[t]=this.fixDateTime(this.config[t])},this),this.config.ranges.map(function(t){return t.startDate=this.fixDateTime(t.startDate),t.endDate=this.fixDateTime(t.endDate),t},this),!1===this.globals.isMobile?(!0===this.config.inline?(this.container=this.$elem.wrapAll("<div class='calentim-container calentim-inline' onclick=''></div>").parent(),this.input=b("<div class='calentim-input'></div>").appendTo(this.container),this.elem.type="hidden",this.config.showButtons=!1,this.setViewport()):(this.container=b("<div class='calentim-container calentim-popup' style='display: none;' onclick=''><div class='calentim-box-arrow-top'></div></div>").appendTo(this.config.container),this.input=b("<div class='calentim-input'></div>").appendTo(this.container),this.config.showButtons&&(this.globals.delayInputUpdate=!0,this.config.autoCloseOnSelect=!1)),"horizontal"===this.config.rangeOrientation?this.input.css("width",this.config.calendarCount*this.config.oneCalendarWidth+"px"):this.input.css("width",this.config.calendarCount*this.config.oneCalendarWidth+this.config.verticalRangeWidth+"px")):(!0===this.config.inline?(this.container=this.$elem.wrapAll("<div class='calentim-container-mobile calentim-inline' onclick=''></div>").parent(),this.input=b("<div class='calentim-input'></div>").appendTo(this.container),this.elem.type="hidden",this.config.showButtons=!1):(this.container=b("<div class='calentim-container-mobile' onclick=''></div>").appendTo(this.config.container),this.input=b("<div class='calentim-input' style='display: none;'></div>").appendTo(this.container),0===b("body > .calentim-overlay").length?(this.overlay=b("<div class='calentim-overlay' style='display: none'></div>").appendTo("body"),this.overlay.on("click.calentim tap.calentim",function(){var t=b("body > .calentim-container-mobile");0<t.length&&t.each(function(){"none"!=b(this).css("display")&&b(this).find(".calentim-cancel").click()})})):this.overlay=b("body > .calentim-overlay").first(),this.config.showButtons&&(this.config.autoCloseOnSelect=!1),this.config.autoCloseOnSelect||(this.globals.delayInputUpdate=!0)),this.$elem.on("focus",function(){b(this).blur()})),this.config.isHotelBooking&&this.container.addClass("calentim-hotel-style"),this.container.data("calentim",this),this.clearRangeSelection()},clearRangeSelection:function(){for(var t=0;t<this.config.ranges.length;t++)this.config.ranges[t].selected=!1;this.container.find(".calentim-range").each(function(){b(this).removeClass("calentim-range-selected")})},fetchInputs:function(){var t,e,i=null,i=-1!==b.inArray(this.config.target.get(0).tagName,this.globals.valElements)?this.config.target.val():this.config.target.text();!1===this.config.singleDate&&0<i.indexOf(this.config.dateSeparator)&&""!==i?2==(t=i.split(this.config.dateSeparator)).length&&moment(t[0],this.config.format,this.config.locale).isValid()&&moment(t[1],this.config.format,this.config.locale).isValid()&&(e=null,this.config.showCalendars&&(moment.isMoment(this.config.startDate)?(e=moment(t[0],this.config.format,this.config.locale),this.config.startDate.year(e.year()).month(e.month()).date(e.date())):this.config.startDate=moment(t[0],this.config.format,this.config.locale),moment.isMoment(this.config.endDate)?(e=moment(t[1],this.config.format,this.config.locale),this.config.endDate.year(e.year()).month(e.month()).date(e.date())):this.config.endDate=moment(t[1],this.config.format,this.config.locale)),this.config.showTimePickers&&(moment.isMoment(this.config.startDate)?(e=moment(t[0],this.config.format,this.config.locale),this.config.startDate.hour(e.hour()).minute(e.minute()).seconds(e.seconds())):this.config.startDate=moment(t[0],this.config.format,this.config.locale),moment.isMoment(this.config.endDate)?(e=moment(t[1],this.config.format,this.config.locale),this.config.endDate.hour(e.hour()).minute(e.minute()).seconds(e.seconds())):this.config.endDate=moment(t[1],this.config.format,this.config.locale)),this.globals.firstValueSelected=!0):!0===this.config.singleDate&&""!==(e=i)&&moment(e,this.config.format,this.config.locale).isValid()&&(this.config.startDate=moment(e,this.config.format,this.config.locale),this.config.endDate=moment(e,this.config.format,this.config.locale),this.globals.firstValueSelected=!0),this.config.startEmpty&&!this.globals.firstValueSelected&&this.clearInput(),this.validateDates(),this.updateTimePickerDisplay()},drawUserInterface:function(){if(this.drawHeader(),this.calendars=this.input.find(".calentim-calendars").first(),!0===this.config.showCalendars){var t=this.globals.currentDate.clone().middleOfDay();this.globals.disabledDays={};for(var e=0;e<this.config.calendarCount;e++)this.drawCalendarOfMonth(t),t=t.month(t.month()+1);this.calendars.find(".calentim-calendar").last().addClass("no-border-right"),this.drawArrows()}else this.calendars.hide(),this.container.addClass("calentim-hidden-calendar");var i;this.drawTimePickers(),this.addKeyboardEvents(),this.drawFooter(),this.reDrawCells(),this.globals.initComplete&&this.setViewport(),this.config.isRTL&&(this.container.css("direction","rtl"),this.container.addClass("calentim-rtl")),!1===this.globals.startSelected&&(this.globals.initComplete?this.updateInput(!1,!1):(i=this.globals.delayInputUpdate,this.globals.delayInputUpdate=!1,this.updateInput(!1,!1),this.globals.delayInputUpdate=i))},drawHeader:function(){var t="<div class='calentim-header'><div class='calentim-header-start'><div class='calentim-header-start-day'></div><div class='calentim-header-start-date'></div><div class='calentim-header-start-weekday'></div></div>";!1===this.config.singleDate&&(t+="<div class='calentim-header-separator'>"+this.config.headerSeparator+"</div><div class='calentim-header-end'><div class='calentim-header-end-day'></div><div class='calentim-header-end-date'></div><div class='calentim-header-end-weekday'></div></div>"),this.input.append(t+="</div><div class='calentim-calendars' tabindex='0'></div>"),!1!==this.config.showHeader&&!1!==this.config.showCalendars||this.input.find(".calentim-header").hide(),this.globals.headerStartDay=this.input.find(".calentim-header-start-day"),this.globals.headerStartDate=this.input.find(".calentim-header-start-date"),this.globals.headerStartWeekday=this.input.find(".calentim-header-start-weekday"),this.globals.headerEndDay=this.input.find(".calentim-header-end-day"),this.globals.headerEndDate=this.input.find(".calentim-header-end-date"),this.globals.headerEndWeekday=this.input.find(".calentim-header-end-weekday"),this.updateHeader()},updateHeader:function(){null!==this.config.startDate?(this.config.startDate.locale(this.config.locale),this.globals.headerStartDay.text(this.localizeNumbers(this.config.startDate.date())),this.globals.isMobile?this.globals.headerStartDate.text(this.config.startDate.format("MMM")+" "+this.localizeNumbers(this.config.startDate.year())):this.globals.headerStartDate.text(this.config.startDate.format("MMMM")+" "+this.localizeNumbers(this.config.startDate.year())),this.globals.headerStartWeekday.text(this.config.startDate.format("dddd"))):(this.globals.headerStartDay.text(""),this.globals.headerStartDate.text(""),this.globals.headerStartWeekday.text("")),!1===this.config.singleDate&&(null!==this.config.endDate?(this.config.endDate.locale(this.config.locale),this.globals.headerEndDay.text(this.localizeNumbers(this.config.endDate.date())),this.globals.isMobile?this.globals.headerEndDate.text(this.config.endDate.format("MMM")+" "+this.localizeNumbers(this.config.endDate.year())):this.globals.headerEndDate.text(this.config.endDate.format("MMMM")+" "+this.localizeNumbers(this.config.endDate.year())),this.globals.headerEndWeekday.text(this.config.endDate.format("dddd"))):(this.globals.headerEndDay.text(""),this.globals.headerEndDate.text(""),this.globals.headerEndWeekday.text("")))},isUpdateable:function(){var t,e=this.globals.delayInputUpdate;return(t=this.config.startEmpty&&!this.globals.firstValueSelected||!0===this.config.singleDate&&null===this.config.startDate||!1===this.config.singleDate&&(null===this.config.startDate||!1===this.globals.startSelected&&null===this.config.endDate))&&this.clearInput(),!t&&!e},updateInput:function(t,e){this.isUpdateable()&&(this.readTimeFromDisplay(!1),this.config.startDate&&this.config.endDate&&(this.config.startDate.locale(this.config.locale),this.config.endDate.locale(this.config.locale),-1!==b.inArray(this.config.target.get(0).tagName,this.globals.valElements)?!1===this.config.singleDate?this.config.target.val(this.config.startDate.format(this.config.format)+this.config.dateSeparator+this.config.endDate.format(this.config.format)):this.config.target.val(this.config.startDate.format(this.config.format)):!1===this.config.singleDate?this.config.target.text(this.config.startDate.format(this.config.format)+this.config.dateSeparator+this.config.endDate.format(this.config.format)):this.config.target.text(this.config.startDate.format(this.config.format)),this.globals.initComplete&&(e?this.config.ontimechange(this,this.config.startDate?this.config.startDate.clone():null,this.config.endDate?this.config.endDate.clone():null):t&&this.config.onafterselect(this,this.config.startDate?this.config.startDate.clone():null,this.config.endDate?this.config.endDate.clone():null),this.input.trigger("change"))))},clearInput:function(t){-1!==b.inArray(this.config.target.get(0).tagName,this.globals.valElements)?(this.config.singleDate,this.config.target.val("")):(this.config.singleDate,this.config.target.text("")),this.config.startDate=null,this.config.endDate=null,this.globals.startDateInitial=null,this.globals.endDateInitial=null,t?(this.config.startEmpty=!0,this.globals.firstValueSelected=!1):1==this.config.startEmpty&&(this.globals.firstValueSelected=!1),this.globals.initComplete&&(this.updateHeader(),0<(t=void 0===this.footer?[]:this.footer.find(".calentim-apply")).length&&t.attr("disabled","disabled"))},drawArrows:function(){var t=this.config.hideOutOfRange&&this.config.minDate&&this.globals.currentDate.clone().add(-1,"month").isBefore(this.config.minDate,"month"),e=this.config.hideOutOfRange&&this.config.maxDate&&this.globals.currentDate.clone().add(this.config.calendarCount,"month").isAfter(this.config.maxDate,"month");0<this.container.find(".calentim-title").length&&(this.globals.isMobile?(t||this.container.find(".calentim-title").prepend("<div class='calentim-prev'>"+this.config.prevMonthIcon+"</div>"),e||this.container.find(".calentim-title").append("<div class='calentim-next'>"+this.config.nextMonthIcon+"</div>")):(t||this.container.find(".calentim-title").first().prepend("<div class='calentim-prev'>"+this.config.prevMonthIcon+"</div>"),e||this.container.find(".calentim-title").last().append("<div class='calentim-next'>"+this.config.nextMonthIcon+"</div>")))},drawCalendarOfMonth:function(t){t.locale(this.config.locale);var e=moment(t).locale(this.config.locale).startOf("month").startOf("isoweek").middleOfDay(),i=e.day(),n=(1==i&&!1===this.config.startOnMonday?(e.subtract(1,"days"),i=0):0===i&&!0===this.config.startOnMonday&&(e.add(1,"days"),i=1),e.isAfter(moment(t).date(1))&&e.add(-7,"day"),"<div class='calentim-calendar"+(this.config.showWeekNumbers?" calentim-calendar-weeknumbers":"")+"' data-month='"+t.month()+"'>"),a=0,s="",o="";this.config.enableMonthSwitcher&&(s=" class='calentim-month-switch'"),this.config.enableYearSwitcher&&(o=" class='calentim-year-switch'"),n=n+("<div class='calentim-title'><span><b"+s+">"+t.format("MMMM")+"</b>&nbsp;<span"+o+">"+this.localizeNumbers(t.year()))+"</span></span></div><div class='calentim-days-container'>",this.config.showWeekNumbers&&(n+="<div class='calentim-dayofweek'>&nbsp;</div>");for(var l=i;l<i+7;l++)n+="<div class='calentim-dayofweek'>"+moment().day(l%7).locale(this.config.locale).format("ddd")+"</div>";for(var s=e.clone().add(-24,"hours").middleOfDay(),c=s.unix(),r=this.isDisabledOnDraw(s);a<42;){var h=e.middleOfDay().unix(),m=t.month()==e.month()?"calentim-day":"calentim-disabled";a%7==0&&this.config.showWeekNumbers&&(n+="<div class='calentim-weeknumber'><span>"+e.format("ww")+"</span></div>"),n+="<div class='"+m+"' data-value='"+h+"'><span>"+this.localizeNumbers(e.date())+"</span></div>",this.isDisabledOnDraw(e)?(this.globals.disabledDays[h]=1==r?2:1,r=!0,c=h):(1==r&&null!=c&&(this.globals.disabledDays[c]=3),r=!1),e.add(moment.duration({days:1})),a++}this.calendars.append(n=n+"</div>"+"</div>")},drawTimePickers:function(){this.input.find(".calentim-timepickers").remove(),this.input.append("<div class='calentim-timepickers'></div>"),this.timepickers=this.input.find(".calentim-timepickers"),this.config.showTimePickers||this.timepickers.hide();var t=0,e=23,i=!1,n=(12==this.config.hourFormat&&(t=1,e=12,i=!0),b("<div class='calentim-timepicker calentim-timepicker-start'></div>").appendTo(this.timepickers));this.addTimePickerHours(n,t,e),this.addTimePickerHourMinuteSeparator(n),this.addTimePickerMinutes(n,this.config.minuteSteps,0,59),i&&this.addTimePickerAMPM(n),!1===this.config.singleDate&&(n=b("<div class='calentim-timepicker calentim-timepicker-end'></div>").appendTo(this.timepickers),this.addTimePickerHours(n,t,e),this.addTimePickerHourMinuteSeparator(n),this.addTimePickerMinutes(n,this.config.minuteSteps,0,59),i&&this.addTimePickerAMPM(n)),this.addTimePickerEvents(),this.updateTimePickerDisplay()},addTimePickerHours:function(t,e,i){t[0].classList.contains("calentim-timepicker-start");var n=b("<div class='calentim-timepicker-hours-wrapper' tabindex='0'></div>").appendTo(t),n=b("<div class='calentim-timepicker-hours'></div>").appendTo(n),a="<div class='calentim-hour-selected-prev'>&nbsp;</div>",a=(a+="<div class='calentim-hour-selected'>"+("00"+e).slice(-2)+"</div>")+("<div class='calentim-hour-selected-next'>"+("00"+(e+1)).slice(-2)+"</div>");n.append(a).data({value:e,min:e,max:i,step:1}),b("<div class='calentim-timepicker-hour-arrows'><div class='calentim-timepicker-hours-up "+(this.config.reverseTimepickerArrows?"calentim-direction-down":"calentim-direction-up")+"'><i class='fa fa-arrow-up'></i></div><div class='calentim-timepicker-hours-down "+(this.config.reverseTimepickerArrows?"calentim-direction-up":"calentim-direction-down")+"'><i class='fa fa-arrow-down'></i></div></div>").appendTo(t)},addTimePickerMinutes:function(t,e,i,n){t[0].classList.contains("calentim-timepicker-start");var a=b("<div class='calentim-timepicker-minutes-wrapper' tabindex='0'></div>").appendTo(t);b("<div class='calentim-timepicker-minutes'></div>").appendTo(a).append("<div class='calentim-minute-selected-prev'>&nbsp;</div><div class='calentim-minute-selected'>00</div><div class='calentim-minute-selected-next'>01</divided>").data({value:i,min:i,max:n%e!=0?n-n%e:n,step:e}),b("<div class='calentim-timepicker-minute-arrows'><div class='calentim-timepicker-minutes-up "+(this.config.reverseTimepickerArrows?"calentim-direction-down":"calentim-direction-up")+"'><i class='fa fa-arrow-up'></i></div><div class='calentim-timepicker-minutes-down "+(this.config.reverseTimepickerArrows?"calentim-direction-up":"calentim-direction-down")+"'><i class='fa fa-arrow-down'></i></div></div>").appendTo(t)},addTimePickerHourMinuteSeparator:function(t){b("<div class='calentim-hour-minute-seperator'>:</div>").appendTo(t)},addTimePickerAMPM:function(t){t[0].classList.contains("calentim-timepicker-start");t=b("<div class='calentim-timepicker-ampm' tabindex='0'></div>").appendTo(t);t.append("<div class='calentim-timepicker-ampm-am'>"+this.localizeAMPM("AM")+"</div>"),t.append("<div class='calentim-timepicker-ampm-pm'>"+this.localizeAMPM("PM")+"</div>")},addTimePickerEvents:function(){function i(t){var e,i,n=t.parents(".calentim-container, .calentim-container-mobile").first().data("calentim"),a=t.parents(".calentim-timepicker").attr("class"),t=t.attr("class"),a=0<=a.indexOf("calentim-timepicker-start")?"start":"end",s=0<t.indexOf("timepicker-minutes")?"minute":"hour",t=0<=t.indexOf("calentim-direction-up")?"up":"down";null!==n.config[a+"Date"]&&(i="hour"==s?1:n.config.minuteSteps,(t=(e=n.config[a+"Date"]).clone().add(!1===n.config.reverseTimepickerArrows?"up"==t?-1*i:i:"down"==t?i:-1*i,s)).set({date:e.date(),month:e.month(),year:e.year()}),i=n.TimeInsideLimits(t,e),n.config[a+"Date"]=i.clone(),n.updateTimePickerDisplay(),n.updateInput(!1,!0))}var n=this;b(c).off("mousedown.calentim").on("mousedown.calentim",".calentim-timepicker-minutes-up, .calentim-timepicker-minutes-down, .calentim-timepicker-hours-up, .calentim-timepicker-hours-down",function(t){var e=this;n.globals.mouseTimer&&clearInterval(n.globals.mouseTimer),i(b(e)),n.globals.mouseTimer=setInterval(function(){i(b(e))},200)}).off("mouseup.calentim").on("mouseup.calentim",function(t){n.globals.mouseTimer&&clearInterval(n.globals.mouseTimer),n.globals.preventMouseClick=!0}).off("click.calentim").on("click.calentim",".calentim-timepicker-minutes-up, .calentim-timepicker-minutes-down, .calentim-timepicker-hours-up, .calentim-timepicker-hours-down",function(t){n.globals.preventMouseClick||i(b(this)),n.globals.preventMouseClick=!1}),this.timepickers.find(".calentim-timepicker-hours-wrapper, .calentim-timepicker-minutes-wrapper").off("mousewheel.calentim DOMMouseScroll.calentim").on("mousewheel.calentim DOMMouseScroll.calentim",function(t){0<(t.originalEvent.wheelDelta||-t.originalEvent.detail)/120?b(t.currentTarget).hasClass("calentim-timepicker-hours-wrapper")?i(b(this).siblings(".calentim-timepicker-hour-arrows").find(".calentim-timepicker-hours-up")):b(t.currentTarget).hasClass("calentim-timepicker-minutes-wrapper")&&i(b(this).siblings(".calentim-timepicker-minute-arrows").find(".calentim-timepicker-minutes-up")):b(t.currentTarget).hasClass("calentim-timepicker-hours-wrapper")?i(b(this).siblings(".calentim-timepicker-hour-arrows").find(".calentim-timepicker-hours-down")):b(t.currentTarget).hasClass("calentim-timepicker-minutes-wrapper")&&i(b(this).siblings(".calentim-timepicker-minute-arrows").find(".calentim-timepicker-minutes-down")),n.stopBubbling(t)}),this.globals.isMobile&&this.timepickers.find(".calentim-timepicker-minutes, .calentim-timepicker-hours").each(function(){var t=new Hammer(this);t.get("pan").set({direction:Hammer.DIRECTION_VERTICAL}),t.on("panmove",n.panThrottle(function(t){var e=b(t.target);return 0<t.velocityY?e.hasClass("calentim-timepicker-hours-wrapper")||0<e.parents(".calentim-timepicker-hours-wrapper").length?(i(e.parents(".calentim-timepicker").find(".calentim-timepicker-hours-up")),n.stopBubbling(t.srcEvent)):(e.hasClass("calentim-timepicker-minutes-wrapper")||0<e.parents(".calentim-timepicker-minutes-wrapper").length)&&(i(e.parents(".calentim-timepicker").find(".calentim-timepicker-minutes-up")),n.stopBubbling(t.srcEvent)):e.hasClass("calentim-timepicker-hours-wrapper")||0<e.parents(".calentim-timepicker-hours-wrapper").length?(i(e.parents(".calentim-timepicker").find(".calentim-timepicker-hours-down")),n.stopBubbling(t.srcEvent)):(e.hasClass("calentim-timepicker-minutes-wrapper")||0<e.parents(".calentim-timepicker-minutes-wrapper").length)&&(i(e.parents(".calentim-timepicker").find(".calentim-timepicker-minutes-down")),n.stopBubbling(t.srcEvent)),!1}))}),this.timepickers.find(".calentim-timepicker-ampm > div").off("click.calentim").on("click.calentim",function(){var t;if(b(this).hasClass("calentim-ampm-selected"))return!1;b(this).addClass("calentim-ampm-selected").siblings().removeClass("calentim-ampm-selected"),n.updateInput(!1,!1),n.config.startDate&&(t=n.config.startDate.clone(),n.config.startDate=n.TimeInsideLimits(n.config.startDate,"start"),!1===n.config.startDate.isSame(t)&&n.updateTimePickerDisplay()),n.config.endDate&&(t=n.config.endDate.clone(),n.config.endDate=n.TimeInsideLimits(n.config.endDate,"end"),!1===n.config.endDate.isSame(t)&&n.updateTimePickerDisplay()),n.updateInput(!1,!0),n.config.ondraw(n)})},panThrottle:function(i){return b.proxy(function(){var t=Array.prototype.slice.call(arguments),e=Math.ceil(Math.abs(t[0].deltaY)/20)||1;this.globals.panScrollPos!=e&&(i.apply(this,t),this.globals.panScrollPos=e)},this)},readTimeFromDisplay:function(t){var e=null,i=null,n="",a="";12==this.config.hourFormat?(n=this.timepickers.find(".calentim-timepicker-start .calentim-hour-selected").text()+" "+this.timepickers.find(".calentim-timepicker-start .calentim-minute-selected").text()+" "+this.timepickers.find(".calentim-timepicker-start .calentim-ampm-selected").text(),e=moment(n,"hh mm a",this.config.locale),!1===this.config.singleDate&&(a=this.timepickers.find(".calentim-timepicker-end .calentim-hour-selected").text()+" "+this.timepickers.find(".calentim-timepicker-end .calentim-minute-selected").text()+" "+this.timepickers.find(".calentim-timepicker-end .calentim-ampm-selected").text(),i=moment(a,"hh mm a",this.config.locale))):(n=this.timepickers.find(".calentim-timepicker-start .calentim-hour-selected").text()+" "+this.timepickers.find(".calentim-timepicker-start .calentim-minute-selected").text(),e=moment(n,"HH mm",this.config.locale),!1===this.config.singleDate&&(a=this.timepickers.find(".calentim-timepicker-end .calentim-hour-selected").text()+" "+this.timepickers.find(".calentim-timepicker-end .calentim-minute-selected").text(),i=moment(a,"HH mm",this.config.locale))),e.isValid()&&null!==this.config.startDate&&this.config.startDate.hours(e.hours()).minutes(e.minutes()).locale(this.config.locale),!1===this.config.singleDate&&i.isValid()&&null!==this.config.endDate&&this.config.endDate.hours(i.hours()).minutes(i.minutes()).locale(this.config.locale),t&&(e&&(this.globals.startTimeBackup=e.clone()),i&&!1===this.config.singleDate&&(this.globals.endTimeBackup=i.clone()))},backupTimePickers:function(){this.readTimeFromDisplay(!0)},restoreTimePickers:function(){12==this.config.hourFormat?(this.globals.startTimeBackup&&this.setStartTimeValue(parseInt(this.globals.startTimeBackup.clone().locale("en").format("hh"),10),parseInt(this.globals.startTimeBackup.clone().locale("en").format("mm"),10),this.globals.startTimeBackup.clone().locale("en").format("a")),!this.config.singleDate&&this.globals.endTimeBackup&&this.setEndTimeValue(parseInt(this.globals.endTimeBackup.clone().locale("en").format("hh"),10),parseInt(this.globals.endTimeBackup.clone().locale("en").format("mm"),10),this.globals.endTimeBackup.clone().locale("en").format("a"))):(this.globals.startTimeBackup&&this.setStartTimeValue(parseInt(this.globals.startTimeBackup.clone().locale("en").format("HH"),10),parseInt(this.globals.startTimeBackup.clone().locale("en").format("mm"),10),null),!this.config.singleDate&&this.globals.endTimeBackup&&this.setEndTimeValue(parseInt(this.globals.endTimeBackup.clone().locale("en").format("HH"),10),parseInt(this.globals.endTimeBackup.clone().locale("en").format("mm"),10),null))},updateTimePickerDisplay:function(){var t,e,i,n;this.timepickers!==a&&(null!==this.config.startDate&&(i=(e=this.config.startDate.clone().locale("en").set({minute:1!=this.config.minuteSteps?Math.round(this.config.startDate.minutes()/this.config.minuteSteps)*this.config.minuteSteps:this.config.startDate.minutes()})).hours(),t=e.minutes(),n=null,12==this.config.hourFormat&&(e=e.format("hh mm a").split(" "),i=parseInt(e[0],10),n=e[2].toLowerCase()),this.setStartTimeValue(i,t,n)),null!==this.config.endDate&&(i=(e=this.config.endDate.clone().locale("en").set({minute:1!=this.config.minuteSteps?Math.round(this.config.endDate.minutes()/this.config.minuteSteps)*this.config.minuteSteps:this.config.endDate.minutes()})).hours(),t=e.minutes(),n=null,12==this.config.hourFormat&&(e=e.format("hh mm a").split(" "),i=parseInt(e[0],10),n=e[2].toLowerCase()),this.setEndTimeValue(i,t,n))),this.TimePickerOutOfLimitView()},setStartTimeValue:function(t,e,i){var n=12==this.config.hourFormat&&this.config.dontPrefixHours?"  ":"00",a=this.timepickers.find(".calentim-timepicker-start"),s=a.find(".calentim-timepicker-hours"),t=(s.data("value",t),s.data()),s=(t&&t.hasOwnProperty("value")&&(s.find(".calentim-hour-selected").text(this.localizeNumbers((n+t.value).slice(-2))),s.find(this.config.reverseTimepickerArrows?".calentim-hour-selected-next":".calentim-hour-selected-prev").text(this.localizeNumbers((t.value-t.step<t.min?n+t.max:n+(t.value-t.step)).slice(-2))),s.find(this.config.reverseTimepickerArrows?".calentim-hour-selected-prev":".calentim-hour-selected-next").text(this.localizeNumbers((t.value+t.step>t.max?n+t.min:n+(t.value+t.step)).slice(-2)))),a.find(".calentim-timepicker-minutes"));s.data("value",e),(t=s.data())&&t.hasOwnProperty("value")&&(s.find(".calentim-minute-selected").text(this.localizeNumbers(("00"+t.value).slice(-2))),s.find(this.config.reverseTimepickerArrows?".calentim-minute-selected-next":".calentim-minute-selected-prev").text(this.localizeNumbers((t.value-t.step<t.min?"00"+t.max:"00"+(t.value-t.step)).slice(-2))),s.find(this.config.reverseTimepickerArrows?".calentim-minute-selected-prev":".calentim-minute-selected-next").text(this.localizeNumbers((t.value+t.step>t.max?"00"+t.min:"00"+(t.value+t.step)).slice(-2)))),null!==i&&(a.find(".calentim-ampm-selected").removeClass("calentim-ampm-selected"),a.find(".calentim-timepicker-ampm-"+i).addClass("calentim-ampm-selected"))},localizeAMPM:function(t){return moment("00:00 "+t,"HH:mm A").locale(this.config.locale).format("A")},localizeNumbers:function(t){return moment.localeData(this.config.locale).postformat(""+t)},setEndTimeValue:function(t,e,i){var n=12==this.config.hourFormat&&this.config.dontPrefixHours?"  ":"00",a=this.timepickers.find(".calentim-timepicker-end"),s=a.find(".calentim-timepicker-hours"),t=(s.data("value",t),s.data()),s=(t&&t.hasOwnProperty("value")&&(s.find(".calentim-hour-selected").text(this.localizeNumbers((n+t.value).slice(-2))),s.find(this.config.reverseTimepickerArrows?".calentim-hour-selected-next":".calentim-hour-selected-prev").text(this.localizeNumbers((t.value-t.step<t.min?n+t.max:n+(t.value-t.step)).slice(-2))),s.find(this.config.reverseTimepickerArrows?".calentim-hour-selected-prev":".calentim-hour-selected-next").text(this.localizeNumbers((t.value+t.step>t.max?n+t.min:n+(t.value+t.step)).slice(-2)))),a.find(".calentim-timepicker-minutes"));s.data("value",e),(t=s.data())&&t.hasOwnProperty("value")&&(s.find(".calentim-minute-selected").text(this.localizeNumbers(("00"+t.value).slice(-2))),s.find(this.config.reverseTimepickerArrows?".calentim-minute-selected-next":".calentim-minute-selected-prev").text(this.localizeNumbers((t.value-t.step<t.min?"00"+t.max:"00"+(t.value-t.step)).slice(-2))),s.find(this.config.reverseTimepickerArrows?".calentim-minute-selected-prev":".calentim-minute-selected-next").text(this.localizeNumbers((t.value+t.step>t.max?"00"+t.min:"00"+(t.value+t.step)).slice(-2)))),null!==i&&(a.find(".calentim-ampm-selected").removeClass("calentim-ampm-selected"),a.find(".calentim-timepicker-ampm-"+i).addClass("calentim-ampm-selected"))},convertLimits:function(t){var e=moment("00:00","HH:mm"),i=moment("23:59","HH:mm");return t.hasOwnProperty("start")&&(e=t.start.hasOwnProperty("ampm")&&"string"==typeof t.start.ampm&&0<=["am","pm"].indexOf(t.start.ampm.toLowerCase())?moment(t.start.hour+":"+t.start.minute+" "+t.start.ampm.toLowerCase(),"h:m a"):moment(t.start.hour+":"+t.start.minute,"H m"),t.hasOwnProperty("end")&&(i=t.end.hasOwnProperty("ampm")&&"string"==typeof t.end.ampm&&0<=["am","pm"].indexOf(t.end.ampm.toLowerCase())?moment(t.end.hour+":"+t.end.minute+" "+t.end.ampm.toLowerCase(),"h:m a"):moment(t.end.hour+":"+t.end.minute,"H m"))),{start:{hour:e.hour(),minute:e.minute()},end:{hour:i.hour(),minute:i.minute()}}},fixLimits:function(t){var e=[{start:{hour:0,minute:0,ampm:null},end:{hour:23,minute:59,ampm:null}}];if(!t)return e;Array.isArray(t)||(t=[t]);var i;for(l=0,len=t.length;l<len;l++)if(0==("object"==typeof(i=t[l])&&i.hasOwnProperty("start")&&i.hasOwnProperty("end")&&i.start.hasOwnProperty("hour")&&0==isNaN(i.start.hour)&&i.start.hasOwnProperty("minute")&&0==isNaN(i.start.minute)&&i.start.hasOwnProperty("ampm")&&("am"==i.start.ampm||"pm"==i.start.ampm||null==i.start.ampm)&&i.end.hasOwnProperty("hour")&&0==isNaN(i.end.hour)&&i.end.hasOwnProperty("minute")&&0==isNaN(i.end.minute)&&i.end.hasOwnProperty("ampm")&&("am"==i.end.ampm||"pm"==i.end.ampm||null==i.end.ampm)))return e;return t},TimeInsideLimits:function(t,e){direction="undefined"==typeof direction?"static":direction;for(var i=this.fixLimits(this.config.limitTimeForDay(t)),n=[],a=0,s=i.length;a<s;a++)if(n[a]=this.convertLimits(i[a]),n[a].startLimit=t.clone().hour(n[a].start.hour).minute(n[a].start.minute),n[a].endLimit=t.clone().hour(n[a].end.hour).minute(n[a].end.minute),t.isBetween(n[a].startLimit,n[a].endLimit,null,"[]"))return t;if("end"==e){for(a=0;a<s;a++)if(n[a].startLimit.isAfter(t))return n[a].startLimit;return n[0].startLimit}if(moment.isMoment(e)){for(a=0;a<s&&!e.isBetween(n[a].startLimit,n[a].endLimit,null,"[]");a++);return e.isAfter(t)?n[0==a?s-1:a-1].endLimit:n[a==s-1?0:a+1].startLimit}for(a=0;a<s;a++)if(n[a].endLimit.isBefore(t))return n[a].endLimit;return n[s-1].endLimit},TimePickerOutOfLimitView:function(){var t,e,i,n;this.config.startDate&&this.timepickers&&(t=this.config.startDate.clone(),e=this.convertLimits(this.config.limitTimeForDay(t.clone())),i=t.clone().hour(e.start.hour).minute(e.start.minute),n=t.clone().hour(e.end.hour).minute(e.end.minute),t.clone().add(1,"hour").isAfter(n,"hour")&&this.timepickers.find(".calentim-timepicker-start .calentim-timepicker-hours .calentim-hour-selected-next").html("&nbsp;"),t.clone().add(-1,"hour").isBefore(i,"hour")&&this.timepickers.find(".calentim-timepicker-start .calentim-timepicker-hours .calentim-hour-selected-prev").html("&nbsp;"),t.clone().add(1,"minute").isAfter(n,"minute")&&this.timepickers.find(".calentim-timepicker-start .calentim-timepicker-minutes .calentim-minute-selected-next").html("&nbsp;"),t.clone().add(-1,"minute").isBefore(i,"minute")&&this.timepickers.find(".calentim-timepicker-start .calentim-timepicker-minutes .calentim-minute-selected-prev").html("&nbsp;")),this.config.endDate&&this.timepickers&&(t=this.config.endDate.clone(),e=this.convertLimits(this.config.limitTimeForDay(t.clone())),i=t.clone().hour(e.start.hour).minute(e.start.minute),n=t.clone().hour(e.end.hour).minute(e.end.minute),t.clone().add(1,"hour").isAfter(n,"hour")&&this.timepickers.find(".calentim-timepicker-end .calentim-timepicker-hours .calentim-hour-selected-next").html("&nbsp;"),t.clone().add(-1,"hour").isBefore(i,"hour")&&this.timepickers.find(".calentim-timepicker-end .calentim-timepicker-hours .calentim-hour-selected-prev").html("&nbsp;"),t.clone().add(1,"minute").isAfter(n,"minute")&&this.timepickers.find(".calentim-timepicker-end .calentim-timepicker-minutes .calentim-minute-selected-next").html("&nbsp;"),t.clone().add(-1,"minute").isBefore(i,"minute")&&this.timepickers.find(".calentim-timepicker-end .calentim-timepicker-minutes .calentim-minute-selected-prev").html("&nbsp;"))},drawFooter:function(){if(!1===this.config.singleDate&&!0===this.config.showFooter&&!0===this.config.showCalendars){"horizontal"===this.config.rangeOrientation||this.globals.isMobile?this.input.append("<div class='calentim-ranges'></div>"):(this.input.addClass("calentim-input-vertical-range"),this.input.wrapInner("<div class='calentim-left'></div>"),b("<div class='calentim-right' style='max-width: "+this.config.verticalRangeWidth+"px; min-width: "+this.config.verticalRangeWidth+"px'><div class='calentim-ranges'></div></div>").insertAfter(this.input.find(".calentim-left")));var t,e=this.input.find(".calentim-ranges");for(t in e.append("<span class='calentim-range-header-container'>"+this.config.rangeIcon+"<div class='calentim-range-header'>"+this.config.rangeLabel+"</div></span>"),this.config.ranges)e.append("<div class='calentim-range"+(this.config.ranges[t].selected?" calentim-range-selected":"")+"' data-id='"+t+"'>"+this.config.ranges[t].title+"</div>")}var i;!this.globals.isMobile||!0!==this.config.singleDate&&!1!==this.config.showFooter||this.input.append("<div class='calentim-filler'></div>"),(this.globals.isMobile&&!this.config.inline||!this.globals.isMobile&&!this.config.inline&&this.config.showButtons)&&(("horizontal"===this.config.rangeOrientation||this.globals.isMobile?this.input:this.input.find(".calentim-right")).append("<div class='calentim-footer'></div>"),this.footer=this.input.find(".calentim-footer"),this.footer.append("<button type='button' class='calentim-cancel'>"+this.config.cancelLabel+"</button>"),this.footer.append("<button type='button' class='calentim-apply'>"+this.config.applyLabel+"</button>"),(!1===this.globals.firstValueSelected&&!0===this.config.startEmpty&&void 0!==this.footer||this.globals.isMobile&&!1===this.globals.endSelected)&&0<(i=void 0===this.footer?[]:this.footer.find(".calentim-apply")).length&&i.attr("disabled","disabled"))},drawNextMonth:function(t){if(t=t||o.event,1==this.config.hideOutOfRange&&this.config.maxDate&&this.globals.currentDate.clone().add(this.config.calendarCount,"month").isAfter(this.config.maxDate,"month"))return!1;var e;null===this.globals.swipeTimeout&&((e=this).globals.swipeTimeout=setTimeout(function(){var t;!0===e.config.onbeforemonthchange(e,e.globals.currentDate?e.globals.currentDate.clone().startOfMonth():null,"next")&&(t=e.calendars.get(0).scrollTop,e.globals.currentDate.middleOfDay().add(1,"month"),e.reDrawCalendars(),e.calendars.get(0).scrollTop=t,e.config.onaftermonthchange(e,e.globals.currentDate?e.globals.currentDate.clone().startOfMonth():null)),e.globals.swipeTimeout=null},"click"==t.type?0:100)),this.stopBubbling(t)},drawPrevMonth:function(t){if(t=t||o.event,1==this.config.hideOutOfRange&&this.config.minDate&&this.globals.currentDate.clone().add(-1,"month").isBefore(this.config.minDate,"month"))return!1;var e;null===this.globals.swipeTimeout&&((e=this).globals.swipeTimeout=setTimeout(function(){var t;!0===e.config.onbeforemonthchange(e,e.globals.currentDate?e.globals.currentDate.clone().startOfMonth():null,"prev")&&(t=e.calendars.get(0).scrollTop,e.globals.currentDate.middleOfDay().subtract(1,"month"),e.reDrawCalendars(),e.calendars.get(0).scrollTop=t,e.config.onaftermonthchange(e,e.globals.currentDate?e.globals.currentDate.clone().startOfMonth():null)),e.globals.swipeTimeout=null},100)),this.stopBubbling(t)},cellClicked:function(t){(t=t||o.event).target=t.target||t.srcElement,!1===b(t.target).hasClass("calentim-day")&&(t.target=b(t.target).closest(".calentim-day").get(0));var e,i=b(t.target).data("value"),i=moment.unix(i).middleOfDay();return 0==this.config.validateClick(i)||(!1===this.config.singleDate?!1===this.globals.startSelected?(null!==this.config.startDate&&(this.globals.startDateBackup=this.config.startDate.clone()),this.config.startDate=i.clone(),this.config.endDate=null,this.globals.startSelected=!0,this.globals.endSelected=!1,this.readTimeFromDisplay(!1),i=this.config.startDate.clone(),this.config.startDate=this.TimeInsideLimits(this.config.startDate,"start"),!1===this.config.startDate.isSame(i)&&this.updateTimePickerDisplay(),0<(e=void 0===this.footer?[]:this.footer.find(".calentim-apply")).length&&e.attr("disabled","disabled"),this.config.onfirstselect(this,this.config.startDate.clone())):(i.isBefore(this.config.startDate)&&(e=this.config.startDate.clone(),this.config.startDate=i.clone(),i=e),i.diff(this.config.startDate,"day")<this.config.minSelectedDays?(this.globals.startSelected=!1,this.fetchInputs()):(this.globals.startDateBackup=null,this.config.endDate=i.clone(),this.globals.endSelected=!0,this.globals.startSelected=!1,this.globals.hoverDate=null,this.readTimeFromDisplay(!1),i=this.config.endDate.clone(),this.config.endDate=this.TimeInsideLimits(this.config.endDate,"end"),!1===this.config.endDate.isSame(i)&&this.updateTimePickerDisplay(),!0===this.config.onbeforeselect(this,this.config.startDate?this.config.startDate.clone():null,this.config.endDate?this.config.endDate.clone():null)&&!0===this.checkRangeContinuity()?(this.globals.firstValueSelected=!0,this.clearRangeSelection(),this.updateInput(!0,!1)):this.fetchInputs(),this.config.autoCloseOnSelect&&!1===this.config.inline?this.hideDropdown(t):void 0!==this.footer&&null!==this.config.endDate&&this.footer.find(".calentim-apply").removeAttr("disabled"))):(this.config.startDate=i.clone(),this.config.endDate=this.config.startDate.clone(),this.globals.endSelected=!0,this.globals.startSelected=!1,this.globals.hoverDate=null,this.readTimeFromDisplay(),i=this.config.startDate.clone(),this.config.startDate=this.TimeInsideLimits(this.config.startDate,"start"),!1===this.config.startDate.isSame(i)&&this.updateTimePickerDisplay(),!0===this.config.onbeforeselect(this,this.config.startDate?this.config.startDate.clone():null,this.config.endDate?this.config.endDate.clone():null)?(this.globals.firstValueSelected=!0,this.clearRangeSelection(),this.updateInput(!0,!1)):this.fetchInputs(),this.config.autoCloseOnSelect&&!1===this.config.inline?this.hideDropdown(t):void 0!==this.footer&&null!==this.config.endDate&&this.footer.find(".calentim-apply").removeAttr("disabled")),this.input.is(":visible")&&(this.reDrawCells(),this.updateHeader()),this.stopBubbling(t)),!1},checkRangeContinuity:function(){var t=this.config.endDate.diff(this.config.startDate,"days");if(this.config.singleDate||0==t)return!0;var e=moment(this.config.startDate).middleOfDay();if(1==this.config.disableOnlyStart)return!1===this.isDisabled(this.config.startDate,this.config.isHotelBooking);if(1==this.config.disableOnlyEnd)return!1===this.isDisabled(this.config.endDate,this.config.isHotelBooking);if(this.config.continuous){var i=e.middleOfDay().unix();if(1==this.isDisabled(i,!1)&&(!this.config.isHotelBooking||1===this.getDisabledLevel(i)))return!1;if(0==e.isSame(this.config.endDate,"day")){e.middleOfDay().add(1,"days");for(var n=0;n<=t-2;n++){if(i=e.middleOfDay().unix(),this.getDisabledLevel(i)!==a)return!1;e.add(1,"days")}}if(i=e.middleOfDay().unix(),1==this.isDisabled(i,!1)&&(!this.config.isHotelBooking||3===this.getDisabledLevel(i)))return!1}return!0},isDisabledOnDraw:function(t){var e=moment(t).middleOfDay();if(!0===this.config.disableDays(e))return!0;for(var i=0;i<this.config.disabledRanges.length;i++){var n=this.config.disabledRanges[i];if(e.isBetween(n.start,n.end,"day","[]"))return!0}},isDisabled:function(t,e){return a===e&&(e=!1),(1!=this.config.disableOnlyStart||1!=this.globals.startSelected)&&((1!=this.config.disableOnlyEnd||0!=this.globals.startSelected)&&("object"==typeof t&&null!==t&&(t=t.clone().middleOfDay().unix()),e&&this.config.isHotelBooking?2===this.globals.disabledDays[t]:this.globals.disabledDays[t]!==a))},getDisabledLevel:function(t){return"object"==typeof t&&null!==t&&(t=t.clone().middleOfDay().unix()),this.globals.disabledDays[t]},cellHovered:function(t){(t=t||o.event).target=t.target||t.srcElement,!1===b(t.target).hasClass("calentim-day")&&(t.target=b(t.target).closest(".calentim-day").get(0));var e=b(t.target).data("value");this.globals.hoverDate=moment.unix(e).middleOfDay(),!(this.globals.keyboardHoverDate=null)===this.globals.startSelected&&this.reDrawCells(),this.stopBubbling(t)},reDrawCalendars:function(){this.backupTimePickers(),this.input.empty(),this.drawUserInterface(),this.restoreTimePickers(),this.container.focus()},monthSwitchClicked:function(){if(!(0<this.calendars.find(".calentim-month-selector").length)){for(var e=this,t=(this.calendars.get(0).scrollTop=0,b("<div class='calentim-month-selector'></div>").appendTo(this.calendars)),i=this.globals.currentDate.get("month"),n=this.globals.currentDate.clone(),a=0;a<12;a++)n.month(a),this.config.hideOutOfRange&&(n.isBefore(this.config.minDate,"month")||n.isAfter(this.config.maxDate,"month"))?t.append("<div class='calentim-ms-month-disabled'>&nbsp;</div>"):t.append("<div class='calentim-ms-month"+(i==a?" current":"")+"' data-month='"+a+"'>"+(this.config.numericMonthSelector?a+1:moment({day:15,hour:12,month:a}).locale(this.config.locale).format(this.config.monthSwitcherFormat))+"</div>");t.css("display","block"),this.optimizeFontSize(t.find(".calentim-ms-month")),t.find(".calentim-ms-month").off("click").on("click",function(t){e.globals.currentDate.month(b(this).data("month")),e.config.onaftermonthchange(e,e.globals.currentDate?e.globals.currentDate.clone().startOfMonth():null),e.calendars.find(".calentim-month-selector").remove(),e.reDrawCalendars(),e.stopBubbling(t)})}},drawYearSwitch:function(t,e){t.empty();var i=this.globals.currentDate.year(),n=(t.data("year",e),e-6),a=e+6;this.config.hideOutOfRange&&(moment(n+"-01-01").isBefore(this.config.minDate,"year")||moment(n+"-12-31").isAfter(this.config.maxDate,"year"))?t.append("<div class='calentim-ys-year-disabled'>&nbsp;</div>"):t.append("<div class='calentim-ys-year-prev'><i class='fa fa-angle-double-left'></i></div>");for(var s=e-6;s<e+7;s++)this.config.hideOutOfRange&&(moment(s+"-06-01").isBefore(this.config.minDate,"year")||moment(s+"-06-01").isAfter(this.config.maxDate,"year"))?t.append("<div class='calentim-ys-year-disabled'>&nbsp;</div>"):t.append("<div class='calentim-ys-year"+(i==s?" current":"")+"' data-year='"+s+"'>"+this.localizeNumbers(s)+"</div>");this.config.hideOutOfRange&&(moment(a+"-01-01").isBefore(this.config.minDate,"year")||moment(a+"-12-31").isAfter(this.config.maxDate,"year"))?t.append("<div class='calentim-ys-year-disabled'>&nbsp;</div>"):t.append("<div class='calentim-ys-year-next'><i class='fa fa-angle-double-right'></i></div>")},yearSwitchClicked:function(){var i,n,t;0<this.calendars.find(".calentim-year-selector").length||((i=this).calendars.get(0).scrollTop=0,n=b("<div class='calentim-year-selector'></div>").appendTo(this.calendars),t=this.globals.currentDate.get("year"),this.drawYearSwitch(n,t),n.css("display","block"),this.optimizeFontSize(n.find(".calentim-ys-year")),b(c).off("click.calentimys").on("click.calentimys",".calentim-ys-year",function(t){i.globals.currentDate.year(b(this).data("year")),i.config.onafteryearchange(i,i.globals.currentDate?i.globals.currentDate.clone().startOf("year"):null),i.reDrawCalendars(),i.calendars.find(".calentim-year-selector").remove(),1==i.config.DOBCalendar&&i.calendars.find(".calentim-calendar").first().find(".calentim-month-switch").click(),i.stopBubbling(t)}),b(c).off("click.calentimysprev").on("click.calentimysprev",".calentim-ys-year-prev",function(t){var e=n.data("year")-13;n.data("year",e),i.drawYearSwitch(n,e),i.stopBubbling(t)}),b(c).off("click.calentimysnext").on("click.calentimysnext",".calentim-ys-year-next",function(t){var e=n.data("year")+13;n.data("year",e),i.drawYearSwitch(n,e),i.stopBubbling(t)}))},optimizeFontSize:function(t){t.each(function(t,e){(e=b(e)).wrapInner("<span class='adjust-subject'></span>").prepend("<span class='font-adjuster'>i</span>");var i=e.find(".adjust-subject"),n=e.find(".font-adjuster");if(i.innerHeight()===n.innerHeight())n.remove(),i.contents().unwrap();else{for(var a=0;i.innerHeight()!==n.innerHeight()&&a<16;){var s=0,s=void 0!==o.getComputedStyle?parseFloat(o.getComputedStyle(n.get(0),null).getPropertyValue("font-size")):parseFloat(n.css("font-size"));if(i.parent().css("font-size",s-1+"px"),n.css("font-size",s-1+"px"),s<2)break;a++}n.remove(),i.contents().unwrap()}})},showDropdown:function(t){t=t||o.event||jQuery.Event("click",{target:this.elem}),t=t.target||t.srcElement;return(!this.globals.isMobile&&"none"==this.container.css("display")||this.globals.isMobile&&"none"==this.input.css("display"))&&(t!==this.elem&&(this.globals.dontHideOnce=!0,this.globals.initiator=t),null!==this.config.startDate&&(this.globals.startDateInitial=this.config.startDate.clone()),null!==this.config.endDate&&(this.globals.endDateInitial=this.config.endDate.clone()),this.fetchInputs(),!1!==this.config.startEmpty&&!this.globals.firstValueSelected||(this.globals.currentDate=moment(this.config.startDate)),0==this.globals.currentDate.isValid()&&(this.globals.currentDate=moment().locale(this.config.locale).middleOfDay()),this.config.onbeforeshow(this),this.globals.isMobile?(this.input.css({display:"flex"}),this.config.inline||this.overlay.show(),b("body").addClass("calentim-open")):this.container.css({display:"block"}),this.globals.lastScrollY=o.scrollY||o.pageYOffset||c.documentElement.scrollTop,this.reDrawCalendars(),1==this.config.DOBCalendar&&this.calendars.find(".calentim-calendar").first().find(".calentim-year-switch").click(),this.config.onaftershow(this)),!1},hideDropdown:function(t){t=t||o.event||jQuery.Event("click",{target:"body"}),t=t.target||t.srcElement;if(this.globals.initiator!==t)return!1===this.config.inline&&(!this.globals.isMobile&&"none"!==this.container.css("display")||this.globals.isMobile&&"none"!==this.input.css("display"))&&(this.config.onbeforehide(this),this.globals.isMobile?(this.input.css({display:"none"}),b("body").removeClass("calentim-open"),this.config.inline||this.overlay.hide()):this.container.css({display:"none"}),(this.globals.hoverDate=null)!==this.globals.startDateBackup&&(this.config.startDate=this.globals.startDateBackup,this.globals.startSelected=!1),this.config.onafterhide(this)),!1},reDrawCells:function(){var t=null!==this.config.startDate?this.config.startDate.clone().middleOfDay().unix():null,e=null!==this.config.endDate?this.config.endDate.clone().middleOfDay().unix():null,i=null!==this.config.minDate?this.config.minDate.clone().middleOfDay().unix():null,n=null!==this.config.maxDate?this.config.maxDate.clone().middleOfDay().unix():null,a=null!==this.globals.hoverDate?this.globals.hoverDate.clone().middleOfDay().unix():null,s=null!==this.globals.keyboardHoverDate?this.globals.keyboardHoverDate.clone().middleOfDay().unix():null,o=moment().middleOfDay().unix();this.lastHoverStatus=!1;for(var l=0;l<this.config.calendarCount;l++)for(var c=this.calendars.find(".calentim-calendar").eq(l),r=c.find(".calentim-days-container > div").not(".calentim-dayofweek, .calentim-weeknumber"),h=c.data("month"),m=0;m<r.length;m++){var d=b(r[m]),f=parseInt(d.attr("data-value")),u=moment.unix(f).middleOfDay().locale(this.config.locale),g="calentim-day",p=u.day();6!=p&&0!==p||(g+=" calentim-weekend"),f===o&&(g+=" calentim-today"),g=this.addDisabledStyles(d,u,f,g,i,n,h),g=this.addSelectedStyles(f,g,t,e,i,n),g=this.addHoverStyles(d,f,g,this,t,a,s),d.attr("class",g)}this.attachEvents(),this.config.ondraw(this)},addSelectedStyles:function(t,e,i,n,a,s){var o=this;return!1!==o.config.startEmpty&&!o.globals.firstValueSelected||(!1===o.config.singleDate&&null!==i&&i===t&&(e+=" calentim-start"),!1===o.config.singleDate&&null!==n&&n===t&&(e+=" calentim-end"),!1===o.config.singleDate&&null!==i&&null!==n&&t<=n&&i<=t&&(e+=" calentim-selected"),!0===o.config.singleDate&&null!==i&&i===t&&(e+=" calentim-selected calentim-start calentim-end")),e},addHoverStyles:function(t,e,i,n,a,s,o){return i.replace("calentim-hovered","").replace("calentim-hovered-last","").replace("calentim-hovered-first",""),!0===this.globals.startSelected&&!1===this.globals.endSelected&&null!==s&&(s<=e&&e<=a||e<=s&&a<=e)&&(i+=" calentim-hovered"),!0===this.config.enableKeyboard&&null!==o&&(!1===this.globals.startSelected?o==e&&(i+=" calentim-hovered"):(e<=a&&o<=e||a<=e&&e<=o)&&(i+=" calentim-hovered")),!1===this.lastHoverStatus&&0<i.indexOf("calentim-hovered")&&(this.lastHoverStatus=!0,i+=" calentim-hovered-first"),!0===this.lastHoverStatus&&i.indexOf("calentim-hovered")<0&&(t.prev(".calentim-day").addClass("calentim-hovered-last"),this.lastHoverStatus=!1),i},addDisabledStyles:function(t,e,i,n,a,s,o){if(this.isDisabled(i))if(0==this.config.isHotelBooking)n=n.replace("calentim-day","calentim-disabled calentim-disabled-range");else switch(this.globals.disabledDays[i]){case 1:n=n.replace("calentim-day","calentim-day calentim-disabled-range calentim-disabled-range-start");break;case 2:n=n.replace("calentim-day","calentim-disabled calentim-disabled-range");break;case 3:n=n.replace("calentim-day","calentim-day calentim-disabled-range calentim-disabled-range-end")}else(null!=s&&s<i||null!=a&&i<a)&&(n=n.replace("calentim-day","calentim-disabled"));return e.month()!=o&&(n+=" calentim-not-in-month"),n},rangeClicked:function(t){var e;if((t=t||o.event).target=t.target||t.srcElement,!1===b(t.target).hasClass("calentim-range")&&(t.target=b(t.target).closest(".calentim-range").get(0)),t.target.hasAttribute("data-id"))return e=b(t.target).attr("data-id"),this.globals.currentDate=this.config.ranges[e].startDate.clone().locale(this.config.locale),this.config.startDate=this.config.ranges[e].startDate.clone().locale(this.config.locale),this.config.endDate=this.config.ranges[e].endDate.clone().locale(this.config.locale),!(this.globals.firstValueSelected=!0)===this.checkRangeContinuity()?this.fetchInputs():(this.clearRangeSelection(),this.config.ranges[e].selected=!0,this.updateTimePickerDisplay(),this.reDrawCalendars(),this.setViewport(),this.config.onrangeselect(this,this.config.ranges[e]),this.config.autoCloseOnSelect&&this.hideDropdown()),this.stopBubbling(t),!1},setViewport:function(){if(!0===this.globals.isMobile)"none"!==this.input.css("display")&&this.container.trigger("calentim:resize");else{if("none"!==this.container.css("display")&&this.globals.initComplete&&!1===this.globals.isMobile&&!1===this.config.inline){var t=this.getViewport();switch(this.config.showOn){case"top":this.config.autoAlign?this.positionOnTopAlign(t):this.positionOnTop(!1,t),this.horizontalAlign(t);break;case"left":this.config.autoAlign?this.positionOnLeftAlign(t):this.positionOnLeft(!1,t),this.verticalAlign(t);break;case"right":this.config.autoAlign?this.positionOnRightAlign(t):this.positionOnRight(!1,t),this.verticalAlign(t);break;case"bottom":this.config.autoAlign?this.positionOnBottomAlign(t):this.positionOnBottom(!1,t),this.horizontalAlign(t);break;case"center":this.positionOnCenter(t);break;default:this.config.autoAlign?this.positionOnBottomAlign(t):this.positionOnBottom(!1,t),this.horizontalAlign(t)}}var e;"horizontal"!==this.config.rangeOrientation&&(e=this.input.find(".calentim-header").outerHeight()+this.input.find(".calentim-calendars").outerHeight()+(0<this.input.find(".calentim-footer").length?this.input.find(".calentim-footer").outerHeight():0)+(0<this.input.find(".calentim-timepickers").length?this.input.find(".calentim-timepickers").outerHeight():0),this.input.find(".calentim-right").css("max-height",e))}},getDropdownPos:function(t){var e=this.getDimensions(this.$elem,!0),i=this.getDimensions(this.container,!0),n=parseInt(this.input.css("margin-left"),10),a=parseFloat(this.container.find("div[class*='calentim-box-arrow']").first().outerHeight()/2);switch(t){case"left":switch(this.config.arrowOn){case"top":return{top:e.offsetTop-n-a-e.height/2,left:e.offsetLeft-i.width-n,arrow:0};case"center":return{top:e.offsetTop-n-i.height/2,left:e.offsetLeft-i.width-n,arrow:(i.height-2*a)/2-e.height/2};case"bottom":return{top:e.offsetTop-i.height+e.height+2*n+a,left:e.offsetLeft-i.width-n,arrow:i.height-4*a-3*n-e.height/2};default:return{top:e.offsetTop-n-a-e.height/2,left:e.offsetLeft-i.width-n,arrow:0}}break;case"right":switch(this.config.arrowOn){case"top":return{top:e.offsetTop-n-a-e.height/2,left:e.offsetLeft+e.width+n,arrow:0};case"center":return{top:e.offsetTop-n-i.height/2,left:e.offsetLeft+e.width+n,arrow:(i.height-2*a)/2-e.height/2};case"bottom":return{top:e.offsetTop-i.height+e.height+2*n+a,left:e.offsetLeft+e.width+n,arrow:i.height-4*a-3*n-e.height/2};default:return{top:e.offsetTop-n-a-e.height/2,left:e.offsetLeft+e.width+n,arrow:0}}break;case"top":switch(this.config.arrowOn){case"left":return{top:e.offsetTop-i.height-n,left:e.offsetLeft-n,arrow:0};case"center":return{top:e.offsetTop-i.height-n,left:e.offsetLeft-(i.width-2*n-e.width)/2,arrow:(i.width-5*a)/2};case"right":return{top:e.offsetTop-i.height-n,left:e.offsetLeft-(i.width-e.width)+n,arrow:i.width-5*a+n};default:return{top:e.offsetTop-i.height-n,left:e.offsetLeft-n,arrow:0}}break;case"bottom":switch(this.config.arrowOn){case"left":return{top:e.offsetTop+e.height-n+a,left:e.offsetLeft-n,arrow:0};case"center":return{top:e.offsetTop+e.height-n+a,left:e.offsetLeft-(i.width-2*n-e.width)/2,arrow:(i.width-5*a)/2};case"right":return{top:e.offsetTop+e.height-n+a,left:e.offsetLeft-(i.width-e.width)+n,arrow:i.width-5*a+n};default:return{top:e.offsetTop+e.height-n+a,left:e.offsetLeft-n,arrow:0}}break;case"center":if("center"===this.config.arrowOn)return{top:e.offsetTop-n-i.height/2,left:e.offsetLeft-(i.width-2*n-e.width)/2}}},verticalAlign:function(t){var e=this.getDimensions(this.container,!0),i=t.top-e.offsetTop,n=e.offsetTop+e.height-t.bottom;0<i&&Math.abs(i)<e.height?(this.container.css({top:function(){return parseFloat(b(this).css("top").replace(/px$/,""))+i}}),this.container.find("div[class*='calentim-box-arrow-']").css({top:function(){return parseFloat(b(this).css("top").replace(/px$/,""))-i}})):0<n&&Math.abs(n)<e.height&&(this.container.css({top:function(){return parseFloat(b(this).css("top").replace(/px$/,""))-n}}),this.container.find("div[class*='calentim-box-arrow-']").css({top:function(){return parseFloat(b(this).css("top").replace(/px$/,""))+n}}))},horizontalAlign:function(t){var e=this.getDimensions(this.container,!0),i=e.offsetLeft+e.width-t.right;0<i&&Math.abs(i)<e.width&&(this.container.css({left:function(){return parseFloat(b(this).css("left").replace(/px$/,""))-i}}),this.container.find("div[class*='calentim-box-arrow-']").css({left:function(){return parseFloat(b(this).css("left").replace(/px$/,""))+i}}))},positionOnTop:function(t,e){var i=this.getDropdownPos("top");if(t)return i;this.container.css({left:i.left,top:i.top}),this.container.find("div[class*='calentim-box-arrow-']").css({left:i.arrow}).attr("class","calentim-box-arrow-bottom")},positionOnBottom:function(t,e){var i=this.getDropdownPos("bottom");if(t)return i;this.container.css({left:i.left,top:i.top}),this.container.find("div[class*='calentim-box-arrow-']").attr("class","calentim-box-arrow-top").css({left:i.arrow})},positionOnLeft:function(t,e){var i=this.getDropdownPos("left");if(t)return i;this.container.css({left:i.left,top:i.top+11}),this.container.children("div[class*='calentim-box-arrow-']").attr("class","calentim-box-arrow-right").css({top:i.arrow})},positionOnRight:function(t,e){var i=this.getDropdownPos("right");if(t)return i;this.container.css({left:i.left,top:i.top+11}),this.container.children("div[class*='calentim-box-arrow-']").attr("class","calentim-box-arrow-left").css({top:i.arrow})},positionOnCenter:function(t){var e=this.getDropdownPos("center"),i=Math.max(e.left+this.container[0].clientWidth-(t.right-30),0),t=Math.max(e.top+this.container[0].clientHeight-(t.bottom-30),0);this.config.autoAlign||(t=i=0),e.left-=i,e.top-=t,this.container.css({left:e.left,top:e.top}),this.container.find("div[class*='calentim-box-arrow-']").remove()},positionOnBottomAlign:function(t){var e=this.positionOnBottom(!0,t),i=this.getDimensions(this.container);e.top+i.height<t.bottom?this.positionOnBottom(!1,t):this.positionOnTop(!1,t)},positionOnLeftAlign:function(t){this.positionOnLeft(!0,t).left>t.left-50?this.positionOnLeft(!1,t):this.positionOnRight(!1,t)},positionOnRightAlign:function(t){var e=this.positionOnRight(!0,t),i=this.getDimensions(this.container);e.left+i.width<t.right+50?this.positionOnRight(!1,t):this.positionOnLeft(!1,t)},positionOnTopAlign:function(t){this.positionOnTop(!0,t).top>t.top?this.positionOnTop(!1,t):this.positionOnBottom(!1,t)},getDimensions:function(t,e){var i=c.body,n=t[0],a=t.offset();if(t===this.$elem&&!1===this.globals.parentScrollEventsAttached){var s=b.proxy(function(){this.globals.isTicking||(this.globals.isTicking=!0,this.globals.rafID=this.requestAnimFrame(b.proxy(function(){this.setViewport(),this.cancelAnimFrame(this.globals.rafID),this.globals.isTicking=!1},this)))},this);if(n!==i)for(var o=n.parentNode;o!==i&&null!==o;)o.scrollHeight>o.offsetHeight&&b(o).off("scroll.calentim").on("scroll.calentim",s),o=o.parentNode;this.globals.parentScrollEventsAttached=!0}return{width:n.offsetWidth,height:n.offsetHeight,offsetLeft:a.left,offsetTop:a.top}},getViewport:function(){var t=this.globals.lastScrollY,e=this.globals.lastScrollX,i=t+o.innerHeight;return{top:t,left:e,right:e+o.innerWidth,bottom:i}},attachEvents:function(){var t=b.proxy(this.drawNextMonth,this),e=b.proxy(this.drawPrevMonth,this),i=b.proxy(this.cellClicked,this),n=b.proxy(this.cellHovered,this),a=b.proxy(this.rangeClicked,this),s=b.proxy(this.monthSwitchClicked,this),o=b.proxy(this.yearSwitchClicked,this),l="click.calentim";this.container.find(".calentim-next").off(l).one(l,t),this.container.find(".calentim-prev").off(l).one(l,e),this.container.find(".calentim-day").off(l).on(l,i),this.container.find(".calentim-day").off("mouseover.calentim").on("mouseover.calentim",n),this.container.find(".calentim-disabled").not(".calentim-day").off(l),this.container.find(".calentim-range").off(l).on(l,a),this.container.find(".calentim-month-switch ").off(l).on(l,s),this.container.find(".calentim-year-switch ").off(l).on(l,o),!0===this.globals.isMobile&&1==this.config.enableSwipe&&("function"==typeof b.fn.swiperight?(this.input.find(".calentim-calendars").css("touch-action","none"),this.input.find(".calentim-calendars").on("swipeleft",t),this.input.find(".calentim-calendars").on("swiperight",e)):((i=new Hammer(this.input.find(".calentim-calendars").get(0))).off("swipeleft").on("swipeleft",t),i.off("swiperight").on("swiperight",e))),!this.globals.isMobile&&!this.config.showButtons||this.config.inline||(this.input.find(".calentim-cancel").off("click.calentim").on("click.calentim",b.proxy(function(t){1==this.config.onCancel(this,this.config.startDate,this.config.endDate)&&(this.config.startDate=this.globals.startDateInitial?this.globals.startDateInitial.clone():null,this.config.endDate=this.globals.endDateInitial?this.globals.endDateInitial.clone():null,this.config.startEmpty&&!this.globals.startDateInitial&&this.clearInput(),this.updateTimePickerDisplay(),this.updateInput(!1,!1),this.hideDropdown(t))},this)),this.input.find(".calentim-apply").off("click.calentim").on("click.calentim",b.proxy(function(t){this.config.startDate=this.config.startDate||moment(),this.config.endDate=this.config.endDate||moment(),!0===this.config.onbeforeselect(this,this.config.startDate.clone(),this.config.endDate.clone())&&!0===this.checkRangeContinuity()?(this.globals.firstValueSelected=!0,this.globals.delayInputUpdate?(this.globals.delayInputUpdate=!1,this.updateInput(!0,!1),this.clearRangeSelection(),this.globals.delayInputUpdate=!0):this.updateInput(!0,!1)):this.fetchInputs(),this.hideDropdown(t)},this)))},addInitialEvents:function(){var e=this,t="click.calentim";this.globals.documentEvent=t+"_"+Math.round((new Date).getTime()+100*Math.random()),b(c).on(this.globals.documentEvent,b.proxy(function(t){var e;!1===this.globals.isMobile&&!1===this.config.inline&&(e=(t=t||o.event||jQuery.Event("click",{target:"body"})).target||t.srcElement,0===b(this.container).find(b(e)).length&&this.elem!==e&&0<this.container.is(":visible")&&this.hideDropdown(t))},this)),this.config.enableKeyboard&&(t="click.calentim focus.calentim"),this.$elem.off(t).on(t,b.proxy(this.debounce(function(t){var t=t||o.event||jQuery.Event("click",{target:"body"}),e=t.target||t.srcElement;0<this.input.get(0).clientHeight&&this.config.target.get(0)!==e?this.hideDropdown(t):(b(c).trigger("click"),this.showDropdown(t))},200,!0),this)),this.globals.isMobile&&b(o).on("resize.calentim",b.proxy(function(t){this.container.trigger("calentim:resize")},this)),this.container.on("calentim:resize",b.proxy(function(){this.globals.rafID=this.requestAnimFrame(function(){var t;e.config.showCalendars?(t=e.input.find(".calentim-calendar:visible:first").innerHeight(),e.input.removeClass("calentim-input-top-reset"),e.input.position().top<0&&e.input.addClass("calentim-input-top-reset"),b(o).width()>b(o).height()?(e.input.find(".calentim-calendars").css({maxHeight:99999,minHeight:t}),"flex"===e.input.css("display")&&(0<e.input.find(".calentim-header:visible").length?e.input.css("height",t+e.input.find(".calentim-header").outerHeight()+2+"px"):e.input.css("height",t+2+"px"))):(e.input.css("height","auto"),e.input.find(".calentim-calendars").css({maxHeight:t,minHeight:0}))):e.input.css("height","auto"),e.updateTimePickerDisplay(),e.cancelAnimFrame(e.globals.rafID)})},this)),"none"!==this.input.css("display")&&this.globals.isMobile&&this.container.trigger("calentim:resize"),!1===this.globals.isMobile&&b(o).on("resize.calentim scroll.calentim",function(){e.globals.isTicking||(e.globals.isTicking=!0,e.globals.lastScrollX=o.scrollX||o.pageXOffset||c.documentElement.scrollLeft,e.globals.lastScrollY=o.scrollY||o.pageYOffset||c.documentElement.scrollTop,e.globals.rafID=e.requestAnimFrame(b.proxy(function(){this.setViewport(),this.globals.isTicking=!1,this.cancelAnimFrame(this.globals.rafID)},e)))})},stopBubbling:function(t){return"function"==typeof t.stopPropagation?t.stopPropagation():void 0!==t.cancelBubble&&(t.cancelBubble=!0),"function"==typeof t.preventDefault&&t.preventDefault(),t.returnValue=!1},debounce:function(n,a,s){return function(){var t=this,e=arguments,i=s&&!t.globals.throttleTimeout;clearTimeout(t.globals.throttleTimeout),t.globals.throttleTimeout=setTimeout(function(){t.globals.throttleTimeout=null,s||n.apply(t,e)},a),i&&n.apply(t,e)}},requestAnimFrame:function(t){return"function"==typeof o.requestAnimationFrame?requestAnimationFrame(t):"function"==typeof o.webkitRequestAnimationFrame?webkitRequestAnimationFrame(t):"function"==typeof o.mozRequestAnimationFrame?mozRequestAnimationFrame(t):setTimeout(t,100/6)},cancelAnimFrame:function(t){return("function"==typeof o.cancelAnimationFrame?cancelAnimationFrame:"function"==typeof o.webkitCancelAnimationFrame?webkitCancelAnimationFrame:"function"==typeof o.mozCancelAnimationFrame?mozCancelAnimationFrame:clearTimeout)(t)},addKeyboardEvents:function(){var t;this.config.enableKeyboard&&this.config.showCalendars&&(t=b.proxy(function(t){var e=t.which||t.keyCode,i=(null===this.globals.keyboardHoverDate?null===this.config.startDate?this.globals.keyboardHoverDate=moment({day:1,month:this.calendars.first().data("month")}).middleOfDay():this.globals.keyboardHoverDate=this.config.startDate.clone().middleOfDay():this.globals.keyboardHoverDate.middleOfDay(),!1),n=!1;switch(e){case 37:this.globals.keyboardHoverDate.add(-1,"day"),n=i=!0;break;case 38:this.globals.keyboardHoverDate.add(-1,"week"),n=i=!0;break;case 39:this.globals.keyboardHoverDate.add(1,"day"),n=i=!0;break;case 40:this.globals.keyboardHoverDate.add(1,"week"),n=i=!0;break;case 32:this.input.find(".calentim-day[data-value='"+this.globals.keyboardHoverDate.middleOfDay().unix()+"']").first().trigger("click.calentim"),n=!(i=!1);break;case 33:t.shiftKey?this.globals.keyboardHoverDate.add(-1,"years"):this.globals.keyboardHoverDate.add(-1,"months"),n=i=!0;break;case 34:t.shiftKey?this.globals.keyboardHoverDate.add(1,"years"):this.globals.keyboardHoverDate.add(1,"months"),n=i=!0;break;case 27:this.hideDropdown(t);break;case 36:t.shiftKey&&(this.globals.keyboardHoverDate=moment().middleOfDay(),n=i=!0)}if(i||n)return this.globals.keyboardHoverDate=this.globals.keyboardHoverDate.middleOfDay(),(this.globals.keyboardHoverDate.isBefore(moment.unix(this.input.find(".calentim-day:first").attr("data-value")),"minute")||this.globals.keyboardHoverDate.isAfter(moment.unix(this.input.find(".calentim-day:last").attr("data-value")),"minute"))&&(this.globals.currentDate=this.globals.keyboardHoverDate.clone().startOfMonth(),this.reDrawCalendars(),i=!1),i&&(this.globals.hoverDate=null,this.reDrawCells()),n&&this.stopBubbling(t),this.container.find(".calentim-calendars").focus(),!1},this),this.$elem.off("keydown.calentim").on("keydown.calentim",b.proxy(function(t){var e=t.which||t.keyCode;return 9==e&&0==t.shiftKey&&0==this.globals.skipTabKeyOnInput?(this.container.find(".calentim-calendars").focus(),!1):(9==e&&0==t.shiftKey&&(this.globals.skipTabKeyOnInput=!1),!0)},this)),this.container.find(".calentim-calendars").off("keydown.calentim").on("keydown.calentim",t),this.timepickers.find(".calentim-timepicker-ampm").off("keydown.calentim").on("keydown.calentim",function(t){var e,i=t.which||t.keyCode,n=t.target||t.currentTarget,a=b(n).parent().hasClass("calentim-timepicker-end");switch(i){case 38:case 40:return b(n).children(":not(.calentim-ampm-selected)").click(),!1;case 9:!a||0!=t.shiftKey||(e=b(n).closest(".calentim-container").data("calentim"))&&(e.globals.skipTabKeyOnInput=!0,e.hideDropdown(),e.$elem.focus().trigger(b.Event("keydown.calentim",{keyCode:9,which:9})))}return!0}),this.timepickers.find(".calentim-timepicker-minutes-wrapper").off("keydown.calentim").on("keydown.calentim",function(t){var e=t.which||t.keyCode,i=t.target||t.currentTarget;switch(e){case 38:return b(i).siblings(".calentim-timepicker-minute-arrows").find(".calentim-timepicker-minutes-up").click(),!1;case 40:return b(i).siblings(".calentim-timepicker-minute-arrows").find(".calentim-timepicker-minutes-down").click(),!1}return!0}),this.timepickers.find(".calentim-timepicker-hours-wrapper").off("keydown.calentim").on("keydown.calentim",function(t){var e=t.which||t.keyCode,i=t.target||t.currentTarget;switch(e){case 38:return b(i).siblings(".calentim-timepicker-hour-arrows").find(".calentim-timepicker-hours-up").click(),!1;case 40:return b(i).siblings(".calentim-timepicker-hour-arrows").find(".calentim-timepicker-hours-down").click(),!1}return!0}))},destroy:function(){this.config.onBeforeDestroy(this)&&(this.config.inline?(this.input.remove(),this.globals.isMobile?this.$elem.unwrap(".calentim-container-mobile"):this.$elem.unwrap(".calentim-container"),this.elem.type="text"):this.container.remove(),b(c).off(this.globals.documentEvent),this.$elem.removeData("calentim"),this.config.ondestroy(this))},fixDateTime:function(t){return t=null!=t&&0==moment.isMoment(t)?("string"==typeof t?moment(t,this.config.format):moment(t)).locale(this.config.locale):t},checkMobile:function(){return o.matchMedia("only screen and (max-width: "+this.config.mobileBreakpoint+"px)").matches},checkTouch:function(){var t=" -webkit- -moz- -o- -ms- ".split(" ");if("ontouchstart"in o||o.DocumentTouch&&c instanceof DocumentTouch)return!0;t=["(",t.join("touch-enabled),("),"heartz",")"].join("");return o.matchMedia(t).matches},setStart:function(t){t=this.fixDateTime(t);!1===this.isDisabled(t)&&moment(t).isValid()&&(this.config.startDate=moment(t),this.config.singleDate&&(this.config.endDate=moment(t)),this.refreshValues())},setEnd:function(t){t=this.fixDateTime(t);!1===this.isDisabled(t)&&moment(t).isValid()&&(this.config.endDate=moment(t),this.refreshValues())},setMinDate:function(t){t=this.fixDateTime(t);moment(t).isValid()&&(this.config.minDate=moment(t),this.refreshValues())},setMaxDate:function(t){t=this.fixDateTime(t);moment(t).isValid()&&(this.config.maxDate=moment(t),this.refreshValues())},setDisplayDate:function(t){t=this.fixDateTime(t);moment(t).isValid()&&(this.globals.currentDate=moment(t),this.reDrawCalendars())},refreshValues:function(){var t=this.globals.delayInputUpdate;this.globals.delayInputUpdate=!1,this.validateDates(),this.updateTimePickerDisplay(),this.updateInput(),this.globals.delayInputUpdate=t,this.reDrawCells()}}).defaults,b.fn.calentim=function(t){return this.each(function(){null==b(this).data("calentim")&&new e(this,t).init()})},"function"!=typeof moment.fn.middleOfDay&&(moment.fn.middleOfDay=function(){return this.hours(12).minutes(0).seconds(0),this},moment.fn.startOfMonth=function(){return this.middleOfDay().date(1),this})}(jQuery,window,document);